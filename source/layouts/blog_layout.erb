<% wrap_layout :layout do

  if current_article.data.hero
    content_for(:hero, "blog/#{current_article.slug}")
  end %>

  <div class="group ts" data-js="append-age-warning"></div>
  <article class="group ts blog__post<% if current_article.data.hero%> blog__post--has-hero<% end %>" data-age="<%= current_article.date %>" data-anchors>
    <h1 class="blog__title"><%= current_article.title %></h1>
    <p class="blog__subtitle p--alpha"><%= partial "partials/journal/posted", :locals => { :a => current_article } %> in <%= partial "partials/journal/category", :locals => { :a => current_article } %></p>
    <% if current_article.data.tldr %>
      <aside class="blog__tldr">
        <p id="tldr"><strong><abbr title="Too long didn’t read">TL;DR</abbr></strong> <em><%= current_article.data.tldr %></em></p>
      </aside>
    <% end %>
    <%= yield %>
    <h2>Good read?</h2>
    <h3>Sharing is caring!</h3>
    <% short_url = current_page.data.short_url ? "sterlini.co/#{current_page.data.short_url}" : "sterlini.co/j#{current_article.url.sub! '/journal', ''}" %>
    <p>Feel free to share it – <a href="http://<%= short_url %>" class="link" id="article-sharelink" title="Share this post with others"><%= short_url %></a>, or chat about it <a href="http://twitter.com/robsterlini" title="Chat to me about this post on Twitter">on Twitter</a>.</p>
    <p>
      <% full_url = "#{url_short}/j#{current_article.url.sub '/journal', ''}"; url_encoded = URI.encode(full_url, /\W/) %>
      <a class="btn twitter-popup love-it" id="twitter-link" href="http://twitter.com/share?text=%E2%80%98<%= URI.encode(current_article.title, /\W/)  %>%E2%80%99%20%40RobSterlini%20%E2%80%93&url=<%= url_encoded %>" title="Loved the article? Share it on Twitter!">Loved it!</a>
    </p>
    <h3>Why not read another?</h3>
    <p>
      <% prev_article = current_article.previous_article; if prev_article %>
        <a class="btn" href="<%= prev_article.url %>" rel="prev" title="Previous article: <%= prev_article.title %>"><%= prev_article.title %></a>
      <% end %>
      <% next_article = current_article.next_article; if next_article %>
        <a class="btn" href="<%= next_article.url %>" rel="next" title="Next article: <%= next_article.title %>"><%= next_article.title %></a>
      <% end %>
    </p>
  </article>

  <script type="text/javascript">
    var articles = {};
    <% if prev_article %>
    articles.prev = {
      url: "<%= prev_article.url %>",
      title: "<%= prev_article.title %>"
    };
    <% end %>
    <% if next_article %>
    articles.nextUp = {
      url: "<%= next_article.url %>",
      title: "<%= next_article.title %>"
    };
    <% end %>
  </script>
  <div class="_baseline-grid"><% for i in 1..1000 %><b></b><% end %></div>
<% end %>